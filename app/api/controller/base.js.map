{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\api\\controller\\base.js"
    ],
    "names": [
        "module",
        "exports",
        "think",
        "Controller",
        "__before",
        "token",
        "ctx",
        "header",
        "tokenSerivce",
        "service",
        "userId",
        "getUserId",
        "publicController",
        "config",
        "publicAction",
        "controllerAction",
        "controller",
        "action",
        "getTime",
        "parseInt",
        "Date",
        "now",
        "getLoginUserId"
    ],
    "mappings": ";;AAAAA,OAAOC,OAAP,GAAiB,cAAcC,MAAMC,UAApB,CAA+B;AACtCC,YAAN,GAAiB;AAAA;;AAAA;AACb;AACAF,kBAAMG,KAAN,GAAc,MAAKC,GAAL,CAASC,MAAT,CAAgB,kBAAhB,KAAuC,EAArD;AACA,kBAAMC,eAAeN,MAAMO,OAAN,CAAc,OAAd,EAAuB,KAAvB,CAArB;AACAP,kBAAMQ,MAAN,GAAe,MAAMF,aAAaG,SAAb,EAArB;AACA,kBAAMC,mBAAmB,MAAKC,MAAL,CAAY,kBAAZ,CAAzB;AACA,kBAAMC,eAAe,MAAKD,MAAL,CAAY,cAAZ,CAArB;AACA;AACA,kBAAME,mBAAmB,MAAKT,GAAL,CAASU,UAAT,GAAsB,GAAtB,GAA4B,MAAKV,GAAL,CAASW,MAA9D;AACA;AACA;AACA;AACA;AACA;AAba;AAchB;AACD;;;;AAIAC,cAAU;AACN,eAAOC,SAASC,KAAKC,GAAL,KAAa,IAAtB,CAAP;AACH;AACD;;;;AAIAC,qBAAiB;AACb,eAAOpB,MAAMQ,MAAb;AACH;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1C4C,CAAhD",
    "file": "..\\..\\..\\src\\api\\controller\\base.js",
    "sourcesContent": [
        "module.exports = class extends think.Controller {\r\n    async __before() {\r\n        // 根据token值获取用户id\r\n        think.token = this.ctx.header['x-nideshop-token'] || '';\r\n        const tokenSerivce = think.service('token', 'api');\r\n        think.userId = await tokenSerivce.getUserId();\r\n        const publicController = this.config('publicController');\r\n        const publicAction = this.config('publicAction');\r\n        // 如果为非公开，则验证用户是否登录\r\n        const controllerAction = this.ctx.controller + '/' + this.ctx.action;\r\n        // if (!publicController.includes(this.ctx.controller) && !publicAction.includes(controllerAction)) {\r\n        //   if (think.userId <= 0) {\r\n        //     return this.fail(401, '请先登录');\r\n        //   }\r\n        // }\r\n    }\r\n    /**\r\n     * 获取时间戳\r\n     * @returns {Number}\r\n     */\r\n    getTime() {\r\n        return parseInt(Date.now() / 1000);\r\n    }\r\n    /**\r\n     * 获取当前登录用户的id\r\n     * @returns {*}\r\n     */\r\n    getLoginUserId() {\r\n        return think.userId;\r\n    }\r\n    //  timestampToTime (unixtimestamp){  \r\n    //    var unixtimestamp = new Date(unixtimestamp*1000);  \r\n    //    var year = 1900 + unixtimestamp.getYear();  \r\n    //    var month = \"0\" + (unixtimestamp.getMonth() + 1);  \r\n    //    var date = \"0\" + unixtimestamp.getDate();  \r\n    //    var hour = \"0\" + unixtimestamp.getHours();  \r\n    //    var minute = \"0\" + unixtimestamp.getMinutes();  \r\n    //    var second = \"0\" + unixtimestamp.getSeconds();  \r\n    //    return year + \"-\" + month.substring(month.length-2, month.length)  + \"-\" + date.substring(date.length-2, date.length)  \r\n    //        + \" \" + hour.substring(hour.length-2, hour.length) + \":\"  \r\n    //        + minute.substring(minute.length-2, minute.length) + \":\"  \r\n    //        + second.substring(second.length-2, second.length);  \r\n    // } \r\n};"
    ]
}