{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\admin\\controller\\goods.js"
    ],
    "names": [
        "Base",
        "require",
        "moment",
        "fs",
        "path",
        "qiniu",
        "module",
        "exports",
        "indexAction",
        "page",
        "get",
        "size",
        "name",
        "model",
        "data",
        "where",
        "is_delete",
        "order",
        "countSelect",
        "item",
        "info",
        "id",
        "category_id",
        "find",
        "category_name",
        "is_on_sale",
        "is_index",
        "product",
        "goods_id",
        "select",
        "ele",
        "spec",
        "goods_specification_ids",
        "value",
        "success",
        "getExpressDataAction",
        "kd",
        "cate",
        "kdData",
        "push",
        "label",
        "cateData",
        "parent_id",
        "infoData",
        "copygoodsAction",
        "goodsId",
        "post",
        "insertId",
        "add",
        "goodsGallery",
        "gallery",
        "img_url",
        "sort_order",
        "updateStock",
        "goods_sn",
        "goods_number",
        "console",
        "log",
        "update",
        "updateGoodsNumberAction",
        "all_goods",
        "goodsSum",
        "sum",
        "think",
        "timeout",
        "onsaleAction",
        "outAction",
        "dropAction",
        "sortAction",
        "index",
        "saleStatusAction",
        "status",
        "sale",
        "checked",
        "productStatusAction",
        "product_id",
        "indexShowStatusAction",
        "stat",
        "infoAction",
        "getAllSpecificationAction",
        "specInfo",
        "specOptionsData",
        "spitem",
        "getAllCategory1Action",
        "is_show",
        "level",
        "c_data",
        "newData",
        "children",
        "citem",
        "getAllCategoryAction",
        "field",
        "c_item",
        "storeAction",
        "values",
        "specData",
        "specValue",
        "cateId",
        "picUrl",
        "list_pic_url",
        "is_new",
        "freight_template_id",
        "retail_price",
        "goods_specifition_name_value",
        "specificationData",
        "specification_id",
        "specId",
        "pro",
        "length",
        "goodsNum",
        "getField",
        "maxPrice",
        "Math",
        "max",
        "minPrice",
        "min",
        "cost",
        "maxCost",
        "minCost",
        "goodsPrice",
        "costPrice",
        "cost_price",
        "min_retail_price",
        "min_cost_price",
        "updatePriceAction",
        "checkSkuAction",
        "isEmpty",
        "fail",
        "updateSortAction",
        "sort",
        "updateShortNameAction",
        "short_name",
        "galleryListAction",
        "galleryAction",
        "url",
        "getGalleryListAction",
        "galleryData",
        "pdata",
        "deleteGalleryFileAction",
        "limit",
        "galleryEditAction",
        "isPost",
        "parseInt",
        "deleteListPicUrlAction",
        "destoryAction",
        "uploadHttpsImageAction",
        "accessKey",
        "config",
        "secretKey",
        "domain",
        "mac",
        "auth",
        "digest",
        "Mac",
        "conf",
        "Config",
        "zoneNum",
        "zone",
        "Zone_z0",
        "Zone_z1",
        "Zone_z2",
        "Zone_na0",
        "Zone_as0",
        "bucketManager",
        "rs",
        "BucketManager",
        "bucket",
        "key",
        "uuid",
        "uploadQiniu",
        "Promise",
        "resolve",
        "reject",
        "fetch",
        "err",
        "respBody",
        "respInfo",
        "statusCode",
        "e",
        "httpsUrl",
        "lastUrl"
    ],
    "mappings": "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",
    "file": "..\\..\\..\\src\\admin\\controller\\goods.js",
    "sourcesContent": [
        "const Base = require('./base.js');\r\nconst moment = require('moment');\r\nconst fs = require('fs');\r\nconst path = require(\"path\");\r\nconst qiniu = require('qiniu');\r\nmodule.exports = class extends Base {\r\n    /**\r\n     * index action\r\n     * @return {Promise} []\r\n     */\r\n    async indexAction() {\r\n        const page = this.get('page') || 1;\r\n        const size = this.get('size');\r\n        const name = this.get('name') || '';\r\n        const model = this.model('goods');\r\n        const data = await model.where({\r\n            name: ['like', `%${name}%`],\r\n            is_delete: 0\r\n        }).order(['sort_order asc']).page(page, size).countSelect();\r\n        // let newData = data;\r\n        for (const item of data.data) {\r\n            const info = await this.model('category').where({\r\n                id: item.category_id\r\n            }).find();\r\n            item.category_name = info.name;\r\n            if (item.is_on_sale == 1) {\r\n                item.is_on_sale = true;\r\n            } else {\r\n                item.is_on_sale = false;\r\n            }\r\n            if (item.is_index == 1) {\r\n                item.is_index = true;\r\n            } else {\r\n                item.is_index = false;\r\n            }\r\n            let product = await this.model('product').where({\r\n                goods_id: item.id,\r\n                is_delete: 0\r\n            }).select();\r\n            for (const ele of product) {\r\n                let spec = await this.model('goods_specification').where({\r\n                    id: ele.goods_specification_ids,\r\n                    is_delete: 0\r\n                }).find();\r\n                ele.value = spec.value;\r\n                ele.is_on_sale = ele.is_on_sale ? \"1\" : \"0\";\r\n            }\r\n            item.product = product;\r\n        }\r\n        return this.success(data);\r\n    }\r\n    async getExpressDataAction() {\r\n        let kd = [];\r\n        let cate = [];\r\n        const kdData = await this.model('freight_template').where({\r\n            is_delete: 0\r\n        }).select();\r\n        for (const item of kdData) {\r\n            kd.push({\r\n                value: item.id,\r\n                label: item.name\r\n            })\r\n        }\r\n        const cateData = await this.model('category').where({\r\n            parent_id: 0\r\n        }).select();\r\n        for (const item of cateData) {\r\n            cate.push({\r\n                value: item.id,\r\n                label: item.name\r\n            })\r\n        }\r\n        let infoData = {\r\n            kd: kd,\r\n            cate: cate\r\n        };\r\n        return this.success(infoData);\r\n    }\r\n    async copygoodsAction() {\r\n        const goodsId = this.post('id');\r\n        let data = await this.model('goods').where({\r\n            id: goodsId\r\n        }).find();\r\n        delete data.id;\r\n        data.is_on_sale = 0;\r\n        let insertId = await this.model('goods').add(data);\r\n        let goodsGallery = await this.model('goods_gallery').where({\r\n            goods_id: goodsId,\r\n            is_delete:0,\r\n        }).select();\r\n        for (const item of goodsGallery) {\r\n            let gallery = {\r\n                img_url: item.img_url,\r\n                sort_order: item.sort_order,\r\n                goods_id: insertId\r\n            }\r\n            await this.model('goods_gallery').add(gallery);\r\n        }\r\n        return this.success(insertId);\r\n    }\r\n    async updateStock(goods_sn, goods_number) {\r\n        console.log('存在，现在就更新');\r\n        await this.model('product').where({\r\n            goods_sn: goods_sn\r\n        }).update({\r\n            goods_number: goods_number\r\n        });\r\n    }\r\n    async updateGoodsNumberAction() {\r\n        let all_goods = await this.model('goods').where({\r\n            is_delete: 0,\r\n            is_on_sale: 1\r\n        }).select();\r\n        for (const item of all_goods) {\r\n            let goodsSum = await this.model('product').where({\r\n                goods_id: item.id\r\n            }).sum('goods_number');\r\n            await this.model('goods').where({\r\n                id: item.id\r\n            }).update({\r\n                goods_number: goodsSum\r\n            });\r\n            await think.timeout(2000);\r\n        }\r\n        return this.success();\r\n    }\r\n    async onsaleAction() {\r\n        const page = this.get('page') || 1;\r\n        const size = this.get('size');\r\n        const model = this.model('goods');\r\n        const data = await model.where({\r\n            is_delete: 0,\r\n            is_on_sale: 1\r\n        }).order(['sort_order asc']).page(page, size).countSelect();\r\n        for (const item of data.data) {\r\n            const info = await this.model('category').where({\r\n                id: item.category_id\r\n            }).find();\r\n            item.category_name = info.name;\r\n            // if (info.parent_id != 0) {\r\n            //     const parentInfo = await this.model('category').where({id: info.parent_id}).find();\r\n            //     item.category_p_name = parentInfo.name;\r\n            // }\r\n            if (item.is_on_sale == 1) {\r\n                item.is_on_sale = true;\r\n            } else {\r\n                item.is_on_sale = false;\r\n            }\r\n            if (item.is_index == 1) {\r\n                item.is_index = true;\r\n            } else {\r\n                item.is_index = false;\r\n            }\r\n            let product = await this.model('product').where({\r\n                goods_id: item.id,\r\n                is_delete: 0\r\n            }).select();\r\n            for (const ele of product) {\r\n                let spec = await this.model('goods_specification').where({\r\n                    id: ele.goods_specification_ids,\r\n                    is_delete: 0\r\n                }).find();\r\n                ele.value = spec.value;\r\n                ele.is_on_sale = ele.is_on_sale ? \"1\" : \"0\";\r\n            }\r\n            item.product = product;\r\n        }\r\n        return this.success(data);\r\n    }\r\n    async outAction() {\r\n        const page = this.get('page') || 1;\r\n        const size = this.get('size');\r\n        const model = this.model('goods');\r\n        const data = await model.where({\r\n            is_delete: 0,\r\n            goods_number: ['<=', 0]\r\n        }).order(['sort_order asc']).page(page, size).countSelect();\r\n        for (const item of data.data) {\r\n            const info = await this.model('category').where({\r\n                id: item.category_id\r\n            }).find();\r\n            item.category_name = info.name;\r\n            if (item.is_on_sale == 1) {\r\n                item.is_on_sale = true;\r\n            } else {\r\n                item.is_on_sale = false;\r\n            }\r\n            if (item.is_index == 1) {\r\n                item.is_index = true;\r\n            } else {\r\n                item.is_index = false;\r\n            }\r\n            let product = await this.model('product').where({\r\n                goods_id: item.id,\r\n                is_delete: 0\r\n            }).select();\r\n            for (const ele of product) {\r\n                let spec = await this.model('goods_specification').where({\r\n                    id: ele.goods_specification_ids,\r\n                    is_delete: 0\r\n                }).find();\r\n                ele.value = spec.value;\r\n                ele.is_on_sale = ele.is_on_sale ? \"1\" : \"0\";\r\n            }\r\n            item.product = product;\r\n        }\r\n        return this.success(data);\r\n    }\r\n    async dropAction() {\r\n        const page = this.get('page') || 1;\r\n        const size = this.get('size');\r\n        const model = this.model('goods');\r\n        const data = await model.where({\r\n            is_delete: 0,\r\n            is_on_sale: 0\r\n        }).order(['id DESC']).page(page, size).countSelect();\r\n        for (const item of data.data) {\r\n            const info = await this.model('category').where({\r\n                id: item.category_id\r\n            }).find();\r\n            item.category_name = info.name;\r\n            if (item.is_on_sale == 1) {\r\n                item.is_on_sale = true;\r\n            } else {\r\n                item.is_on_sale = false;\r\n            }\r\n            if (item.is_index == 1) {\r\n                item.is_index = true;\r\n            } else {\r\n                item.is_index = false;\r\n            }\r\n            let product = await this.model('product').where({\r\n                goods_id: item.id,\r\n                is_delete: 0\r\n            }).select();\r\n            for (const ele of product) {\r\n                let spec = await this.model('goods_specification').where({\r\n                    id: ele.goods_specification_ids,\r\n                    is_delete: 0\r\n                }).find();\r\n                ele.value = spec.value;\r\n                ele.is_on_sale = ele.is_on_sale ? \"1\" : \"0\";\r\n            }\r\n            item.product = product;\r\n        }\r\n        return this.success(data);\r\n    }\r\n    async sortAction() {\r\n        const page = this.get('page') || 1;\r\n        const size = this.get('size');\r\n        const model = this.model('goods');\r\n        const index = this.get('index');\r\n        if (index == 1) {\r\n            const data = await model.where({\r\n                is_delete: 0\r\n            }).order(['sell_volume DESC']).page(page, size).countSelect();\r\n            for (const item of data.data) {\r\n                const info = await this.model('category').where({\r\n                    id: item.category_id\r\n                }).find();\r\n                item.category_name = info.name;\r\n                if (item.is_on_sale == 1) {\r\n                    item.is_on_sale = true;\r\n                } else {\r\n                    item.is_on_sale = false;\r\n                }\r\n                if (item.is_index == 1) {\r\n                    item.is_index = true;\r\n                } else {\r\n                    item.is_index = false;\r\n                }\r\n                let product = await this.model('product').where({\r\n                    goods_id: item.id,\r\n                    is_delete: 0\r\n                }).select();\r\n                for (const ele of product) {\r\n                    let spec = await this.model('goods_specification').where({\r\n                        id: ele.goods_specification_ids,\r\n                        is_delete: 0\r\n                    }).find();\r\n                    ele.value = spec.value;\r\n                    ele.is_on_sale = ele.is_on_sale ? \"1\" : \"0\";\r\n                }\r\n                item.product = product;\r\n            }\r\n            return this.success(data);\r\n        } else if (index == 2) {\r\n            const data = await model.where({\r\n                is_delete: 0\r\n            }).order(['retail_price DESC']).page(page, size).countSelect();\r\n            for (const item of data.data) {\r\n                const info = await this.model('category').where({\r\n                    id: item.category_id\r\n                }).find();\r\n                item.category_name = info.name;\r\n                if (item.is_on_sale == 1) {\r\n                    item.is_on_sale = true;\r\n                } else {\r\n                    item.is_on_sale = false;\r\n                }\r\n                if (item.is_index == 1) {\r\n                    item.is_index = true;\r\n                } else {\r\n                    item.is_index = false;\r\n                }\r\n                let product = await this.model('product').where({\r\n                    goods_id: item.id,\r\n                    is_delete: 0\r\n                }).select();\r\n                for (const ele of product) {\r\n                    let spec = await this.model('goods_specification').where({\r\n                        id: ele.goods_specification_ids,\r\n                        is_delete: 0\r\n                    }).find();\r\n                    ele.value = spec.value;\r\n                    ele.is_on_sale = ele.is_on_sale ? \"1\" : \"0\";\r\n                }\r\n                item.product = product;\r\n            }\r\n            return this.success(data);\r\n        } else if (index == 3) {\r\n            const data = await model.where({\r\n                is_delete: 0\r\n            }).order(['goods_number DESC']).page(page, size).countSelect();\r\n            for (const item of data.data) {\r\n                const info = await this.model('category').where({\r\n                    id: item.category_id\r\n                }).find();\r\n                item.category_name = info.name;\r\n                if (item.is_on_sale == 1) {\r\n                    item.is_on_sale = true;\r\n                } else {\r\n                    item.is_on_sale = false;\r\n                }\r\n                if (item.is_index == 1) {\r\n                    item.is_index = true;\r\n                } else {\r\n                    item.is_index = false;\r\n                }\r\n                let product = await this.model('product').where({\r\n                    goods_id: item.id,\r\n                    is_delete: 0\r\n                }).select();\r\n                for (const ele of product) {\r\n                    let spec = await this.model('goods_specification').where({\r\n                        id: ele.goods_specification_ids,\r\n                        is_delete: 0\r\n                    }).find();\r\n                    ele.value = spec.value;\r\n                    ele.is_on_sale = ele.is_on_sale ? \"1\" : \"0\";\r\n                }\r\n                item.product = product;\r\n            }\r\n            return this.success(data);\r\n        }\r\n    }\r\n    async saleStatusAction() {\r\n        const id = this.get('id');\r\n        const status = this.get('status');\r\n        let sale = 0;\r\n        if (status == 'true') {\r\n            sale = 1;\r\n        }\r\n        const model = this.model('goods');\r\n        await model.where({\r\n            id: id\r\n        }).update({\r\n            is_on_sale: sale\r\n        });\r\n        await this.model('cart').where({\r\n            goods_id: id\r\n        }).update({\r\n            is_on_sale: sale,\r\n            checked: sale\r\n        });\r\n    }\r\n    async productStatusAction() {\r\n        const id = this.get('id');\r\n        const status = this.get('status');\r\n        const model = this.model('product');\r\n        await model.where({\r\n            id: id\r\n        }).update({\r\n            is_on_sale: status\r\n        });\r\n\t\t// 4.14更新\r\n\t\tawait this.model('cart').where({\r\n\t\t\tproduct_id: id,\r\n\t\t\tis_delete: 0\r\n\t\t}).update({\r\n\t\t\tis_on_sale: status\r\n\t\t})\r\n    }\r\n    async indexShowStatusAction() {\r\n        const id = this.get('id');\r\n        const status = this.get('status');\r\n        let stat = 0;\r\n        if (status == 'true') {\r\n            stat = 1;\r\n        }\r\n        const model = this.model('goods');\r\n        await model.where({\r\n            id: id\r\n        }).update({\r\n            is_index: stat\r\n        });\r\n    }\r\n    async infoAction() {\r\n        const id = this.get('id');\r\n        const model = this.model('goods');\r\n        const data = await model.where({\r\n            id: id\r\n        }).find();\r\n        let category_id = data.category_id;\r\n        let infoData = {\r\n            info: data,\r\n            category_id: category_id,\r\n        };\r\n        return this.success(infoData);\r\n    }\r\n    async getAllSpecificationAction() {\r\n        const specInfo = await this.model('specification').where({\r\n            id: ['>', 0]\r\n        }).select();\r\n        let specOptionsData = [];\r\n        for (const spitem of specInfo) {\r\n            let info = {\r\n                value: spitem.id,\r\n                label: spitem.name\r\n            };\r\n            specOptionsData.push(info);\r\n        }\r\n        return this.success(specOptionsData);\r\n    }\r\n    async getAllCategory1Action() { // 我写的算法\r\n        const model = this.model('category');\r\n        const data = await model.where({\r\n            is_show: 1,\r\n            level: 'L1'\r\n        }).select();\r\n        const c_data = await model.where({\r\n            is_show: 1,\r\n            level: 'L2'\r\n        }).select();\r\n        let newData = [];\r\n        for (const item of data) {\r\n            let children = [];\r\n            for (const citem of c_data) {\r\n                if (citem.parent_id == item.id) {\r\n                    children.push({\r\n                        value: citem.id,\r\n                        label: citem.name\r\n                    })\r\n                }\r\n            }\r\n            newData.push({\r\n                value: item.id,\r\n                label: item.name,\r\n                children: children\r\n            });\r\n        }\r\n        return this.success(newData);\r\n    }\r\n    async getAllCategoryAction() { // 晓玲的算法，她要\r\n        const model = this.model('category');\r\n        const data = await model.where({\r\n            is_show: 1,\r\n            level: 'L1'\r\n        }).field('id,name').select();\r\n        let newData = [];\r\n        for (const item of data) {\r\n            let children = [];\r\n            const c_data = await model.where({\r\n                is_show: 1,\r\n                level: 'L2',\r\n                parent_id: item.id\r\n            }).field('id,name').select();\r\n            for (const c_item of c_data) {\r\n                children.push({\r\n                    value: c_item.id,\r\n                    label: c_item.name\r\n                })\r\n            }\r\n            newData.push({\r\n                value: item.id,\r\n                label: item.name,\r\n                children: children\r\n            });\r\n        }\r\n        return this.success(newData);\r\n    }\r\n    async storeAction() {\r\n        const values = this.post('info');\r\n        const specData = this.post('specData');\r\n        const specValue = this.post('specValue');\r\n        const cateId = this.post('cateId');\r\n        const model = this.model('goods');\r\n        let picUrl = values.list_pic_url;\r\n        let goods_id = values.id;\r\n        values.category_id = cateId;\r\n        values.is_index = values.is_index ? 1 : 0;\r\n        values.is_new = values.is_new ? 1 : 0;\r\n        let id = values.id;\r\n        if (id > 0) {\r\n            await model.where({\r\n                id: id\r\n            }).update(values);\r\n            await this.model('cart').where({\r\n                goods_id: id\r\n            }).update({\r\n                checked: values.is_on_sale,\r\n                is_on_sale: values.is_on_sale,\r\n                list_pic_url: picUrl,\r\n                freight_template_id: values.freight_template_id\r\n            });\r\n            await this.model('product').where({\r\n                goods_id: id\r\n            }).update({\r\n                is_delete: 1\r\n            });\r\n            await this.model('goods_specification').where({\r\n                goods_id: id\r\n            }).update({\r\n                is_delete: 1\r\n            });\r\n            for (const item of specData) {\r\n                if (item.id > 0) {\r\n                    await this.model('cart').where({\r\n                        product_id: item.id,\r\n                        is_delete: 0,\r\n                    }).update({\r\n                        retail_price: item.retail_price,\r\n                        goods_specifition_name_value: item.value,\r\n                        goods_sn: item.goods_sn\r\n                    });\r\n                    delete item.is_delete;\r\n                    item.is_delete = 0;\r\n                    await this.model('product').where({\r\n                        id: item.id\r\n                    }).update(item);\r\n                    let specificationData = {\r\n                        value: item.value,\r\n                        specification_id: specValue,\r\n                        is_delete: 0\r\n                    };\r\n                    await this.model('goods_specification').where({\r\n                        id: item.goods_specification_ids\r\n                    }).update(specificationData);\r\n                } else {\r\n                    let specificationData = {\r\n                        value: item.value,\r\n                        goods_id: id,\r\n                        specification_id: specValue\r\n                    }\r\n                    let specId = await this.model('goods_specification').add(specificationData);\r\n                    item.goods_specification_ids = specId;\r\n                    item.goods_id = id;\r\n                    await this.model('product').add(item);\r\n                }\r\n            }\r\n        } else {\r\n            delete values.id;\r\n            goods_id = await model.add(values);\r\n            for (const item of specData) {\r\n                let specificationData = {\r\n                    value: item.value,\r\n                    goods_id: goods_id,\r\n                    specification_id: specValue\r\n                }\r\n                let specId = await this.model('goods_specification').add(specificationData);\r\n                item.goods_specification_ids = specId;\r\n                item.goods_id = goods_id;\r\n                item.is_on_sale = 1;\r\n                await this.model('product').add(item);\r\n            }\r\n        }\r\n        let pro = await this.model('product').where({\r\n            goods_id: goods_id,\r\n            is_on_sale: 1,\r\n            is_delete: 0\r\n        }).select();\r\n        if (pro.length > 1) {\r\n            let goodsNum = await this.model('product').where({\r\n                goods_id: goods_id,\r\n                is_on_sale: 1,\r\n                is_delete: 0\r\n            }).sum('goods_number');\r\n            let retail_price = await this.model('product').where({\r\n                goods_id: goods_id,\r\n                is_on_sale: 1,\r\n                is_delete: 0\r\n            }).getField('retail_price');\r\n            let maxPrice = Math.max(...retail_price);\r\n            let minPrice = Math.min(...retail_price);\r\n            let cost = await this.model('product').where({\r\n                goods_id: goods_id,\r\n                is_on_sale: 1,\r\n                is_delete: 0\r\n            }).getField('cost');\r\n            let maxCost = Math.max(...cost);\r\n            let minCost = Math.min(...cost);\r\n            let goodsPrice = '';\r\n            if(minPrice == maxPrice){\r\n                goodsPrice = minPrice;\r\n            }\r\n            else{\r\n                goodsPrice = minPrice + '~' + maxPrice;\r\n            }\r\n            let costPrice = minCost + '~' + maxCost;\r\n            await this.model('goods').where({\r\n                id: goods_id\r\n            }).update({\r\n                goods_number: goodsNum,\r\n                retail_price: goodsPrice,\r\n                cost_price: costPrice,\r\n                min_retail_price: minPrice,\r\n                min_cost_price: minCost,\r\n            });\r\n        } else {\r\n            let info = {\r\n                goods_number: pro[0].goods_number,\r\n                retail_price: pro[0].retail_price,\r\n                cost_price: pro[0].cost,\r\n                min_retail_price: pro[0].retail_price,\r\n                min_cost_price: pro[0].cost,\r\n            }\r\n            await this.model('goods').where({\r\n                id: goods_id\r\n            }).update(info);\r\n        }\r\n        return this.success(values);\r\n    }\r\n    async updatePriceAction() {\r\n        let data = this.post('');\r\n        // console.log(data);\r\n        await this.model('goods_specification').where({\r\n            id: data.goods_specification_ids\r\n        }).update({\r\n            value: data.value\r\n        });\r\n        await this.model('product').where({\r\n            id: data.id\r\n        }).update(data);\r\n        await this.model('cart').where({\r\n            product_id: data.id,\r\n            is_delete: 0,\r\n        }).update({\r\n            retail_price: data.retail_price,\r\n            goods_specifition_name_value: data.value,\r\n            goods_sn: data.goods_sn\r\n        });\r\n        delete data.value;\r\n        let goods_id = data.goods_id;\r\n        let pro = await this.model('product').where({\r\n            goods_id: goods_id,\r\n            is_on_sale: 1,\r\n            is_delete: 0\r\n        }).select();\r\n        if (pro.length > 1) {\r\n            let goodsNum = await this.model('product').where({\r\n                goods_id: goods_id,\r\n                is_on_sale: 1,\r\n                is_delete: 0\r\n            }).sum('goods_number');\r\n            let retail_price = await this.model('product').where({\r\n                goods_id: goods_id,\r\n                is_on_sale: 1,\r\n                is_delete: 0\r\n            }).getField('retail_price');\r\n            let maxPrice = Math.max(...retail_price);\r\n            let minPrice = Math.min(...retail_price);\r\n            let cost = await this.model('product').where({\r\n                goods_id: goods_id,\r\n                is_on_sale: 1,\r\n                is_delete: 0\r\n            }).getField('cost');\r\n            let maxCost = Math.max(...cost);\r\n            let minCost = Math.min(...cost);\r\n            let goodsPrice = '';\r\n            if(minPrice == maxPrice){\r\n                goodsPrice = minPrice;\r\n            }\r\n            else{\r\n                goodsPrice = minPrice + '~' + maxPrice;\r\n            }\r\n            let costPrice = minCost + '~' + maxCost;\r\n            await this.model('goods').where({\r\n                id: goods_id\r\n            }).update({\r\n                goods_number: goodsNum,\r\n                retail_price: goodsPrice,\r\n                cost_price: costPrice,\r\n                min_retail_price: minPrice,\r\n                min_cost_price: minCost,\r\n            });\r\n        } else {\r\n            let info = {\r\n                goods_number: pro[0].goods_number,\r\n                retail_price: pro[0].retail_price,\r\n                cost_price: pro[0].cost,\r\n                min_retail_price: pro[0].retail_price,\r\n                min_cost_price: pro[0].cost,\r\n            }\r\n            await this.model('goods').where({\r\n                id: goods_id\r\n            }).update(info);\r\n        }\r\n        return this.success();\r\n    }\r\n    async checkSkuAction() {\r\n        const info = this.post('info');\r\n        if (info.id > 0) {\r\n            const model = this.model('product');\r\n            const data = await model.where({\r\n                id: ['<>', info.id],\r\n                goods_sn: info.goods_sn,\r\n                is_delete: 0\r\n            }).find();\r\n            if (!think.isEmpty(data)) {\r\n                return this.fail(100, '重复')\r\n            } else {\r\n                return this.success();\r\n            }\r\n        } else {\r\n            const model = this.model('product');\r\n            const data = await model.where({\r\n                goods_sn: info.goods_sn,\r\n                is_delete: 0\r\n            }).find();\r\n            if (!think.isEmpty(data)) {\r\n                return this.fail(100, '重复')\r\n            } else {\r\n                return this.success();\r\n            }\r\n        }\r\n    }\r\n    async updateSortAction() {\r\n        const id = this.post('id');\r\n        const sort = this.post('sort');\r\n        const model = this.model('goods');\r\n        const data = await model.where({\r\n            id: id\r\n        }).update({\r\n            sort_order: sort\r\n        });\r\n        return this.success(data);\r\n    }\r\n    async updateShortNameAction() {\r\n        const id = this.post('id');\r\n        const short_name = this.post('short_name');\r\n        const model = this.model('goods');\r\n        const data = await model.where({\r\n            id: id\r\n        }).update({\r\n            short_name: short_name\r\n        });\r\n        return this.success(data);\r\n    }\r\n    async galleryListAction() {\r\n        const id = this.get('id');\r\n        const model = this.model('goods_gallery');\r\n        const data = await model.where({\r\n            goods_id: id,\r\n            is_delete:0\r\n        }).select();\r\n        // console.log(data);\r\n        return this.success(data);\r\n    }\r\n    async galleryAction() {\r\n        const url = this.post('url');\r\n        const id = this.post('goods_id');\r\n        let info = {\r\n            goods_id: id,\r\n            img_url: url\r\n        }\r\n        await this.model('goods_gallery').add(info);\r\n        return this.success();\r\n    }\r\n    async getGalleryListAction() {\r\n        const goodsId = this.post('goodsId');\r\n        const data = await this.model('goods_gallery').where({\r\n            goods_id: goodsId,\r\n            is_delete:0\r\n        }).select();\r\n        let galleryData = [];\r\n        for (const item of data) {\r\n            let pdata = {\r\n                id: item.id,\r\n                url: item.img_url\r\n            }\r\n            galleryData.push(pdata);\r\n        }\r\n        let info = {\r\n            galleryData: galleryData,\r\n        }\r\n        return this.success(info);\r\n    }\r\n    async deleteGalleryFileAction() {\r\n        const url = this.post('url');\r\n        const id = this.post('id');\r\n        await this.model('goods_gallery').where({\r\n            id: id\r\n        }).limit(1).update({\r\n            is_delete: 1\r\n        });\r\n        return this.success('文件删除成功');\r\n    }\r\n    async galleryEditAction() {\r\n        if (!this.isPost) {\r\n            return false;\r\n        }\r\n        const values = this.post();\r\n        let data = values.data;\r\n        // console.log(data);\r\n        const model = this.model('goods_gallery');\r\n        for (const item of data) {\r\n            let id = item.id;\r\n            let sort = parseInt(item.sort_order);\r\n            // console.log(sort);\r\n            await this.model('goods_gallery').where({\r\n                id: id\r\n            }).update({\r\n                sort_order: sort\r\n            });\r\n        }\r\n        return this.success();\r\n    }\r\n    async deleteListPicUrlAction() {\r\n        const id = this.post('id');\r\n        console.log(id);\r\n        await this.model('goods').where({\r\n            id: id\r\n        }).limit(1).update({\r\n            list_pic_url: 0\r\n        });\r\n        return this.success();\r\n    }\r\n    async destoryAction() {\r\n        const id = this.post('id');\r\n        await this.model('goods').where({\r\n            id: id\r\n        }).limit(1).update({\r\n            is_delete: 1\r\n        });\r\n        await this.model('product').where({\r\n            goods_id: id\r\n        }).update({\r\n            is_delete: 1\r\n        });\r\n        await this.model('goods_specification').where({\r\n            goods_id: id\r\n        }).update({\r\n            is_delete: 1\r\n        });\r\n        // TODO 删除图片\r\n        return this.success();\r\n    }\r\n    async uploadHttpsImageAction() {\r\n        let url = this.post('url');\r\n        console.log('----------------------');\r\n        console.log(url);\r\n        let accessKey = think.config('qiniuHttps.access_key');\r\n        let secretKey = think.config('qiniuHttps.secret_key');\r\n        let domain = think.config('qiniuHttps.domain');\r\n        var mac = new qiniu.auth.digest.Mac(accessKey, secretKey);\r\n        var config = new qiniu.conf.Config();\r\n        let zoneNum = think.config('qiniuHttps.zoneNum');\r\n        if(zoneNum == 0){\r\n            config.zone = qiniu.zone.Zone_z0;\r\n        }\r\n        else if(zoneNum == 1){\r\n            config.zone = qiniu.zone.Zone_z1;\r\n        }\r\n        else if(zoneNum == 2){\r\n            config.zone = qiniu.zone.Zone_z2;\r\n        }\r\n        else if(zoneNum == 3){\r\n            config.zone = qiniu.zone.Zone_na0;\r\n        }\r\n\r\n        else if(zoneNum == 4){\r\n            config.zone = qiniu.zone.Zone_as0;\r\n        }\r\n        var bucketManager = new qiniu.rs.BucketManager(mac, config);\r\n        let bucket = think.config('qiniuHttps.bucket');\r\n        let key = think.uuid(32);\r\n        await think.timeout(500);\r\n        const uploadQiniu = async() => {\r\n            return new Promise((resolve, reject) => {\r\n                try {\r\n                    bucketManager.fetch(url, bucket, key, function(err, respBody, respInfo) {\r\n                        if (err) {\r\n                            console.log(err);\r\n                            //throw err;\r\n                        } else {\r\n                            if (respInfo.statusCode == 200) {\r\n                                resolve(respBody.key)\r\n                            } else {\r\n                                console.log(respInfo.statusCode);\r\n                            }\r\n                        }\r\n                    });\r\n                } catch (e) {\r\n                    return resolve(null);\r\n                }\r\n            })\r\n        };\r\n        const httpsUrl = await uploadQiniu();\r\n        console.log(httpsUrl);\r\n        let lastUrl = domain + httpsUrl;\r\n        return this.success(lastUrl);\r\n    }\r\n};"
    ]
}